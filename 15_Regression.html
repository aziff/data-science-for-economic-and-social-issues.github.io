<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>15&nbsp; Regression â€“ Data Science for Economic and Social Issues</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./16_Program_Evaluation.html" rel="next">
<link href="./14_Inference.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f9a69956bae15ee19585fe71e7f92375.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
// This script is used to dynamically set the aria-label attribute for elements
document.addEventListener('DOMContentLoaded', function() {
    // Set aria-label for the label element if it is empty
    const label = document.querySelector('label.aa-Label[for^="autocomplete-0-input"]');
    // Check if the label exists and is empty
    if (label && !label.textContent.trim()){
        label.setAttribute('aria-label', 'Search');
    }
});
</script>

<script src="scroll-access.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13_CLT.html">Statistical Methods and Econometrics</a></li><li class="breadcrumb-item"><a href="./15_Regression.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Economic and Social Issues</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Setup</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quick Start: Installation Instructions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Command_Line_and_Git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Command Line and Git</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">R and R Markdown Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_R_Basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_R_Markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Code Structure</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Cleaning and Describing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data_Loading_Saving.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loading and Saving Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Data_Management.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_Merging_and_Reshaping_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Merging and Reshaping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Summary_Statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Summary Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_Geographic_Data_and_Mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Geographic Data and Mapping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Methods and Econometrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_CLT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Central Limit Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_Inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_Regression.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_Program_Evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Program Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_Instrumental_Variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Instrumental Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_Discontinuity_Designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Discontinuity Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_Difference_in_Differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Fixed Effects and Difference-in-Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_EventStudies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Event Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_MachineLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Machine Learning Basics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#regression" id="toc-regression" class="nav-link active" data-scroll-target="#regression"><span class="header-section-number">15.1</span> Regression</a>
  <ul class="collapse">
  <li><a href="#interpretation-of-linear-and-non-linear-specifications" id="toc-interpretation-of-linear-and-non-linear-specifications" class="nav-link" data-scroll-target="#interpretation-of-linear-and-non-linear-specifications"><span class="header-section-number">15.1.1</span> Interpretation of Linear and Non-Linear Specifications</a></li>
  <li><a href="#regression-assumptions" id="toc-regression-assumptions" class="nav-link" data-scroll-target="#regression-assumptions"><span class="header-section-number">15.1.2</span> Regression Assumptions</a></li>
  </ul></li>
  <li><a href="#categorical-outcome-variables" id="toc-categorical-outcome-variables" class="nav-link" data-scroll-target="#categorical-outcome-variables"><span class="header-section-number">15.2</span> Categorical Outcome Variables</a></li>
  <li><a href="#the-goal-of-program-evaluation" id="toc-the-goal-of-program-evaluation" class="nav-link" data-scroll-target="#the-goal-of-program-evaluation"><span class="header-section-number">15.3</span> The Goal of Program Evaluation</a>
  <ul class="collapse">
  <li><a href="#causality-vs.-correlation" id="toc-causality-vs.-correlation" class="nav-link" data-scroll-target="#causality-vs.-correlation"><span class="header-section-number">15.3.1</span> Causality vs.&nbsp;Correlation</a></li>
  </ul></li>
  <li><a href="#activity-practice-with-regression" id="toc-activity-practice-with-regression" class="nav-link" data-scroll-target="#activity-practice-with-regression"><span class="header-section-number">15.4</span> Activity: Practice with Regression</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">15.5</span> References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./13_CLT.html">Statistical Methods and Econometrics</a></li><li class="breadcrumb-item"><a href="./15_Regression.html"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Regression is a powerful tool to investigate the dependence of one variable on another <span class="citation" data-cites="casella_statistical_2002">Casella and Berger (<a href="#ref-casella_statistical_2002" role="doc-biblioref">2002</a>)</span>. In this chapter, we will review linear regression, its common pitfalls, and some useful non-linear specifications (logit and probit).</p>
<section id="regression" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="regression"><span class="header-section-number">15.1</span> Regression</h2>
<p>In the population, suppose there are three random variables <span class="math inline">\(X\)</span>, <span class="math inline">\(U\)</span>, and <span class="math inline">\(Y\)</span>. Because they are radnom variables, they have some underlying probability distributions and may have a statistical relationship. Generally, we may think of <span class="math inline">\(Y\)</span> as a function of <span class="math inline">\(X\)</span> and <span class="math inline">\(U\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
Y = f(X, U).
\end{equation*}\]</span></p>
<p>We are not saying that <span class="math inline">\(X\)</span> and <span class="math inline">\(U\)</span> cause <span class="math inline">\(Y\)</span> or anything like that. All we are saying is that we think there is a way to write <span class="math inline">\(Y\)</span> as depending on the values that <span class="math inline">\(X\)</span> and <span class="math inline">\(U\)</span> take. In practice, having a general function <span class="math inline">\(f()\)</span> makes the problem harder. We can assume that the function is linear. Even if it is not actually linear, a linear function is often an adequate approximation.</p>
<p>Suppose we have a sample of size <span class="math inline">\(N\)</span> units, indexed by <span class="math inline">\(i\)</span>. That is, <span class="math inline">\(i = 1, 2, 3, \ldots, N\)</span>. Each unit <span class="math inline">\(i\)</span> has a realization of the random variables: <span class="math inline">\(Y_i\)</span>, <span class="math inline">\(X_i\)</span>, and <span class="math inline">\(U_i\)</span>. Suppose that <span class="math inline">\(U\)</span> is unobservable. That means that our dataset contains <span class="math inline">\((X_1, X_2, \ldots, X_N)\)</span> and <span class="math inline">\((Y_1, Y_2, \ldots, Y_N)\)</span>. We can set up the linear regression as</p>
<p><span class="math display">\[\begin{equation*}
Y = \beta_0 + \beta_1 X + U.
\end{equation*}\]</span></p>
<p>Note that <span class="math inline">\(U\)</span> is unobserved so it does not matter if it has a coefficient attached to it. It is common to assume that <span class="math inline">\(\mathbb{E}(U) = 0\)</span>. Even if this were not the case, the intercept <span class="math inline">\(\beta_0\)</span> can be rescaled to accommodate it. Then, the interpretation is that the expected value of <span class="math inline">\(Y\)</span> given the value of <span class="math inline">\(X = x\)</span> is:</p>
<p><span class="math display">\[\begin{equation*}
\mathbb{E}(Y \vert X = x) = \beta_0 + \beta_1 x.
\end{equation*}\]</span></p>
<p>The estimation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> can be done using Ordinary Least Squares (OLS). Let us use R for this. We will use data from the General Social Survey (GSS) available on Canvas for download. Suppose we are interested of the relationship between education and income.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to set your working directory first</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#setwd("Your/Working/Directory/Here")</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>gss <span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"Data/Regression/GSS2022.dta"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize education and income</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>gss <span class="sc">%&gt;%</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(educ, conrinc) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      educ          conrinc        
 Min.   : 0.00   Min.   :   316.5  
 1st Qu.:12.00   1st Qu.: 15033.8  
 Median :14.00   Median : 28485.0  
 Mean   :14.15   Mean   : 40508.0  
 3rd Qu.:16.00   3rd Qu.: 52222.5  
 Max.   :20.00   Max.   :163572.7  
 NA's   :29      NA's   :1804      </code></pre>
</div>
</div>
<p>While it would work to write out the expressions for the OLS estimator explicitly in R, it is practical to use a function for linear regression. The built-in function <code>lm()</code> is great. Note that it uses the formula specification where <code>~</code> means equals. Given that we specify the data, we should not reference variables using <code>gss$conrinc</code> or similar subsetting methods. Note that it automatically estimates a regression with an intercept.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> conrinc <span class="sc">~</span> educ,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> gss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conrinc ~ educ, data = gss)

Coefficients:
(Intercept)         educ  
     -28642         4761  </code></pre>
</div>
</div>
<p>If you want to estimate the regression without the intercept, subtract 1 or add 0.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> conrinc <span class="sc">~</span> educ <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> gss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conrinc ~ educ - 1, data = gss)

Coefficients:
educ  
2862  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> conrinc <span class="sc">~</span> educ <span class="sc">+</span> <span class="dv">0</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> gss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conrinc ~ educ + 0, data = gss)

Coefficients:
educ  
2862  </code></pre>
</div>
</div>
<p>While the print out of this command is useful to get the broad strokes the regression, there is a lot more information hidden in the object that <code>lm()</code> returns. Assign the output to an object in the environment to see it. That way you can access elements of it as a list.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> conrinc <span class="sc">~</span> educ,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co">#str(out)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "na.action"     "xlevels"       "call"          "terms"        
[13] "model"        </code></pre>
</div>
</div>
<p>These elements may be particularly useful.</p>
<ul>
<li><code>coefficients</code>. This vector contains the estimated coefficients.</li>
<li><code>residuals</code>. For each unit, the residual is <span class="math inline">\(Y_i - \hat{Y}_i\)</span>. In this example, that is <span class="math inline">\(Y_i - \hat{\beta}_0 + \hat{\beta}_1 X_i\)</span>.</li>
<li><code>fitted.values</code>. For each unit, <span class="math inline">\(\hat{Y}_i\)</span>.</li>
<li><code>df.residual</code>. Residual degrees of freedom. This is the number of units minus the number of coefficients.</li>
<li><code>na.action</code>. Information about <code>NA</code> values and how they were handled.</li>
<li><code>xlevels</code>. If the variables are factors, then information about the levels.</li>
</ul>
<p>We can take this a step furhter using <code>summary()</code>. This is a more convenient output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conrinc ~ educ, data = gss)

Residuals:
   Min     1Q Median     3Q    Max 
-66253 -22788  -9521   9725 173172 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -28641.9     3961.2  -7.231  6.5e-13 ***
educ          4760.6      267.5  17.796  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 36390 on 2329 degrees of freedom
  (1818 observations deleted due to missingness)
Multiple R-squared:  0.1197,    Adjusted R-squared:  0.1193 
F-statistic: 316.7 on 1 and 2329 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>out_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(out)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#str(out_summary)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(out_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "call"          "terms"         "residuals"     "coefficients" 
 [5] "aliased"       "sigma"         "df"            "r.squared"    
 [9] "adj.r.squared" "fstatistic"    "cov.unscaled"  "na.action"    </code></pre>
</div>
</div>
<p>Notice that the object from <code>summary()</code> has other elements. These elements may be particularly useful.</p>
<ul>
<li><code>coefficients</code>. Note that this looks different and has more information than <code>out$coefficients</code>. It also contains the standard errors, <span class="math inline">\(t\)</span>-statistics (the estimated coefficient divided by the standard error), and the two-sided <span class="math inline">\(p\)</span>-value testing if the coefficient is different than 0.</li>
<li><code>sigma</code>. Mean square error where <span class="math inline">\(p\)</span> is the number of coefficients: <span class="math inline">\(\frac{1}{n - p} \sum_{i}^n Y_i - \hat{Y}_i\)</span>.</li>
<li><code>df</code>. A vector with three numbers: the total number of coefficients from covariates that are not linearly dependent <span class="math inline">\((p)\)</span>, the number of observations minus this <span class="math inline">\((n-p)\)</span>, and the total number of coefficients includign those that are linearly dependent. Note that you want the first and last numbers to be the same. Otherwise, you are specifying a linear regression with multicollinearity.</li>
<li><code>r.squared</code>. If there is an intercept, it can be intuitively understood as the fraction of variance that the model explains. The formula is <span class="math inline">\(1 - \frac{\frac{1}{n - p} \sum_{i}^n Y_i - \hat{Y}_i}{\sum_i^n (Y_i - \bar{Y})^2}\)</span>.</li>
<li><code>adj.r.squared</code>. This <span class="math inline">\(R^2\)</span> is the same idea but it penalizes additional covariates.</li>
<li><code>fstatistic</code>. A vector with three numbers: the <span class="math inline">\(F\)</span>-statistic and its degrees of freedom.</li>
</ul>
<p>Now that we are comfortable with the basics of <code>lm()</code>, let us explore adding more variables and using other specifications. To add variables, use <code>+</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a variable for experience</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>gss <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exp =</span> age <span class="sc">-</span> (educ <span class="sc">+</span> <span class="dv">5</span>))</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> conrinc <span class="sc">~</span> educ <span class="sc">+</span> exp,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = conrinc ~ educ + exp, data = gss)

Residuals:
   Min     1Q Median     3Q    Max 
-73546 -20917  -7928   9913 170963 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -42069.86    4337.30   -9.70  &lt; 2e-16 ***
educ          5030.36     270.28   18.61  &lt; 2e-16 ***
exp            383.12      51.91    7.38 2.22e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 35790 on 2237 degrees of freedom
  (1909 observations deleted due to missingness)
Multiple R-squared:  0.1425,    Adjusted R-squared:  0.1418 
F-statistic: 185.9 on 2 and 2237 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The classic Mincer equation regresses the log of the wage on education, experience, and experience squared. We can do these mathematical transformations within the formula call. It can also be done by creating a new variable or transforming the existing variable in the dataset. Just be mindful of the values. For example, given we are taking the log of income, we should check that there are no incomes less than or equal to zero. The function <code>I()</code> ensures that the formula interprets the expression as mathematical (i.e., squared) rather than an expression for the formula.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2), data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3915 -0.4422  0.1464  0.6327  3.5533 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.143e+00  1.268e-01   56.32   &lt;2e-16 ***
educ         1.443e-01  7.551e-03   19.11   &lt;2e-16 ***
exp          7.815e-02  5.146e-03   15.19   &lt;2e-16 ***
I(exp^2)    -1.254e-03  9.171e-05  -13.67   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9974 on 2236 degrees of freedom
  (1909 observations deleted due to missingness)
Multiple R-squared:  0.2156,    Adjusted R-squared:  0.2145 
F-statistic: 204.9 on 3 and 2236 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Also remember that linear regression means linear in the coefficients. That means that it is fine to have non-linear functions of the covariates like we do for experience squared. These are all continuous variables. It is common to want to include dummies. It does not matter if the variable is numeric (0 or 1) or logical (TRUE or FALSE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sex,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2) + sex, data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.1993 -0.4232  0.1642  0.5970  3.3478 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.740e+00  1.378e-01   56.17   &lt;2e-16 ***
educ         1.478e-01  7.401e-03   19.98   &lt;2e-16 ***
exp          7.623e-02  5.042e-03   15.12   &lt;2e-16 ***
I(exp^2)    -1.227e-03  8.983e-05  -13.66   &lt;2e-16 ***
sex         -4.128e-01  4.136e-02   -9.98   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9763 on 2234 degrees of freedom
  (1910 observations deleted due to missingness)
Multiple R-squared:  0.2491,    Adjusted R-squared:  0.2477 
F-statistic: 185.2 on 4 and 2234 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Let us add a categorical variable that takes more than two values (not an indicator). Notice that the values of race are 1, 2, 3, and <code>NA</code> corresponding to white, black, other, and missing. If we incldue the variable as-is in the regression, interpretation will be difficult. An easy fix is to transform it to a factor variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gss<span class="sc">$</span>race, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 &lt;NA&gt; 
2651  775  659   64 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sex <span class="sc">+</span> race,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2) + sex + race, 
    data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.1945 -0.4223  0.1623  0.6018  3.3459 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.732e+00  1.459e-01  52.985   &lt;2e-16 ***
educ         1.481e-01  7.428e-03  19.936   &lt;2e-16 ***
exp          7.604e-02  5.063e-03  15.020   &lt;2e-16 ***
I(exp^2)    -1.223e-03  9.026e-05 -13.550   &lt;2e-16 ***
sex         -4.161e-01  4.157e-02 -10.009   &lt;2e-16 ***
race         5.859e-03  2.745e-02   0.213    0.831    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9776 on 2216 degrees of freedom
  (1927 observations deleted due to missingness)
Multiple R-squared:  0.2496,    Adjusted R-squared:  0.2479 
F-statistic: 147.4 on 5 and 2216 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformed to a factor variable</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sex <span class="sc">+</span> <span class="fu">as.factor</span>(race),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2) + sex + as.factor(race), 
    data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2060 -0.4303  0.1736  0.5881  3.3330 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       7.760e+00  1.398e-01  55.502   &lt;2e-16 ***
educ              1.467e-01  7.435e-03  19.730   &lt;2e-16 ***
exp               7.612e-02  5.056e-03  15.057   &lt;2e-16 ***
I(exp^2)         -1.225e-03  9.014e-05 -13.595   &lt;2e-16 ***
sex              -4.076e-01  4.164e-02  -9.789   &lt;2e-16 ***
as.factor(race)2 -1.258e-01  5.604e-02  -2.246   0.0248 *  
as.factor(race)3  5.791e-02  5.745e-02   1.008   0.3135    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9762 on 2215 degrees of freedom
  (1927 observations deleted due to missingness)
Multiple R-squared:  0.252, Adjusted R-squared:   0.25 
F-statistic: 124.4 on 6 and 2215 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># More careful transformation to a factor variable</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>gss <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_factor =</span> <span class="fu">factor</span>(race, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"WHITE"</span>, <span class="st">"BLACK"</span>, <span class="st">"OTHER"</span>)))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that it automatically omits the first level of the factor, in this case WHITE</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use relevel to set a different reference</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>gss <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">race_factor =</span> <span class="fu">relevel</span>(race_factor, <span class="at">ref =</span> <span class="st">"BLACK"</span>))</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> sex <span class="sc">+</span> race_factor,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2) + sex + race_factor, 
    data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2060 -0.4303  0.1736  0.5881  3.3330 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       7.635e+00  1.444e-01  52.855   &lt;2e-16 ***
educ              1.467e-01  7.435e-03  19.730   &lt;2e-16 ***
exp               7.612e-02  5.056e-03  15.057   &lt;2e-16 ***
I(exp^2)         -1.225e-03  9.014e-05 -13.595   &lt;2e-16 ***
sex              -4.076e-01  4.164e-02  -9.789   &lt;2e-16 ***
race_factorWHITE  1.258e-01  5.604e-02   2.246   0.0248 *  
race_factorOTHER  1.838e-01  7.148e-02   2.571   0.0102 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9762 on 2215 degrees of freedom
  (1927 observations deleted due to missingness)
Multiple R-squared:  0.252, Adjusted R-squared:   0.25 
F-statistic: 124.4 on 6 and 2215 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Interactions can be added with <code>*</code> or <code>:</code>. Note the difference below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> sex<span class="sc">*</span>educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> race_factor,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ sex * educ + exp + I(exp^2) + race_factor, 
    data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.2681 -0.4289  0.1682  0.5915  3.2842 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       8.117e+00  3.465e-01  23.425  &lt; 2e-16 ***
sex              -7.343e-01  2.173e-01  -3.379 0.000739 ***
educ              1.134e-01  2.300e-02   4.929 8.86e-07 ***
exp               7.612e-02  5.054e-03  15.062  &lt; 2e-16 ***
I(exp^2)         -1.225e-03  9.011e-05 -13.593  &lt; 2e-16 ***
race_factorWHITE  1.248e-01  5.602e-02   2.228 0.025957 *  
race_factorOTHER  1.854e-01  7.147e-02   2.594 0.009537 ** 
sex:educ          2.250e-02  1.468e-02   1.532 0.125667    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9759 on 2214 degrees of freedom
  (1927 observations deleted due to missingness)
Multiple R-squared:  0.2528,    Adjusted R-squared:  0.2505 
F-statistic:   107 on 7 and 2214 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="at">formula =</span> <span class="fu">log</span>(conrinc) <span class="sc">~</span> sex<span class="sc">:</span>educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> race_factor,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ sex:educ + exp + I(exp^2) + race_factor, 
    data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8045 -0.5021  0.1699  0.6831  3.1987 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       8.9383502  0.1034027  86.442  &lt; 2e-16 ***
exp               0.0811234  0.0055512  14.614  &lt; 2e-16 ***
I(exp^2)         -0.0013716  0.0000988 -13.882  &lt; 2e-16 ***
race_factorWHITE  0.2438159  0.0612984   3.978 7.19e-05 ***
race_factorOTHER  0.3035977  0.0783431   3.875  0.00011 ***
sex:educ          0.0050231  0.0026394   1.903  0.05715 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.073 on 2216 degrees of freedom
  (1927 observations deleted due to missingness)
Multiple R-squared:  0.09584,   Adjusted R-squared:  0.0938 
F-statistic: 46.98 on 5 and 2216 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<section id="interpretation-of-linear-and-non-linear-specifications" class="level3" data-number="15.1.1">
<h3 data-number="15.1.1" class="anchored" data-anchor-id="interpretation-of-linear-and-non-linear-specifications"><span class="header-section-number">15.1.1</span> Interpretation of Linear and Non-Linear Specifications</h3>
<p>The interpretation of the coefficients depends on the specification. I go through common specifications below.</p>
<ul>
<li><p>Linear. <span class="math inline">\(Y = \beta_0 + \beta_1 X + U\)</span>. Increasing <span class="math inline">\(X\)</span> by one unit changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1\)</span> units on average.</p></li>
<li><p>Log-Linear. <span class="math inline">\(\ln(Y) = \beta_0 + \beta_1 X+ U\)</span>. Increasing <span class="math inline">\(X\)</span> by one unit approximately changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1 \times 100\)</span> percent on average.</p></li>
<li><p>Linear-Log. <span class="math inline">\(Y = \beta_0 + \beta_1 \ln(X)+ U\)</span>. Increasing <span class="math inline">\(X\)</span> by one percent approximately changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1 \times 0.01\)</span> percent on average.</p></li>
<li><p>Log-Log. <span class="math inline">\(\ln(Y) = \beta_0 + \beta_1 \ln(X)+ U\)</span>. Increasing <span class="math inline">\(X\)</span> by one percent approximately changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1 \times 100\)</span> percent on average.</p></li>
<li><p>Multivariate Regression. <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \beta_2 X_1 + \ldots + U\)</span>. Increasing <span class="math inline">\(X_1\)</span> by one unit changes changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1\)</span> units, holding all other covariates constant, changes <span class="math inline">\(Y\)</span> by <span class="math inline">\(\hat{\beta}_1\)</span> on average.</p></li>
</ul>
</section>
<section id="regression-assumptions" class="level3" data-number="15.1.2">
<h3 data-number="15.1.2" class="anchored" data-anchor-id="regression-assumptions"><span class="header-section-number">15.1.2</span> Regression Assumptions</h3>
<p>Now that we are empowered with R to run regressions, it can be easy to lose sight of the theory. Recall the core assumptions of the classic framework.</p>
<ol type="1">
<li><p>Linear Model. This assumption states that the true model of the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is linear.</p></li>
<li><p>Strict Exogeneity. <span class="math inline">\(\mathbb{E}(U \vert X) = \mathbb{E}(U) = 0.\)</span> This is a stronger way of saying that <span class="math inline">\(U\)</span> and <span class="math inline">\(X\)</span> are uncorrelated. A common way to break this assumption is to have ommited variable bias.</p></li>
<li><p>No Perfect Multicollinearity. The covariates need to be linearly independent. For example, the below regression drops age because it is a linear function of experience. But, experience squared is allowed because it is not a linear function of experience.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(<span class="fu">log</span>(conrinc) <span class="sc">~</span> educ <span class="sc">+</span> exp <span class="sc">+</span> <span class="fu">I</span>(exp<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> age,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(conrinc) ~ educ + exp + I(exp^2) + age, data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.3915 -0.4422  0.1464  0.6327  3.5533 

Coefficients: (1 not defined because of singularities)
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  7.143e+00  1.268e-01   56.32   &lt;2e-16 ***
educ         1.443e-01  7.551e-03   19.11   &lt;2e-16 ***
exp          7.815e-02  5.146e-03   15.19   &lt;2e-16 ***
I(exp^2)    -1.254e-03  9.171e-05  -13.67   &lt;2e-16 ***
age                 NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9974 on 2236 degrees of freedom
  (1909 observations deleted due to missingness)
Multiple R-squared:  0.2156,    Adjusted R-squared:  0.2145 
F-statistic: 204.9 on 3 and 2236 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Homoscedasticity. The variance of the error term is constant and finite.</li>
</ol>
</section>
</section>
<section id="categorical-outcome-variables" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="categorical-outcome-variables"><span class="header-section-number">15.2</span> Categorical Outcome Variables</h2>
<p>Above, we always assumed that <span class="math inline">\(Y\)</span> was continuous. If <span class="math inline">\(Y\)</span> is discrete, then we want to consider alternative specifications. We can certainly use the variable as is. However, the interpretation may not capture the goal of the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Diabetes </span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gss<span class="sc">$</span>diabetes, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2 &lt;NA&gt; 
 293 2060 1796 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Interpreting variable as if it were numeric</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(diabetes <span class="sc">~</span> educ,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = diabetes ~ educ, data = gss)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8756  0.1246  0.1248  0.1251  0.1260 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.874e+00  3.611e-02  51.893   &lt;2e-16 ***
educ        8.692e-05  2.433e-03   0.036    0.972    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3307 on 2336 degrees of freedom
  (1811 observations deleted due to missingness)
Multiple R-squared:  5.465e-07, Adjusted R-squared:  -0.0004275 
F-statistic: 0.001277 on 1 and 2336 DF,  p-value: 0.9715</code></pre>
</div>
</div>
<p>For the case of a binary <span class="math inline">\(Y\)</span> variable (it only takes two values), common specifications are probit and logit. Probit uses the cumulative distribution function (CDF) of the Normal distribution</p>
<p><span class="math display">\[\begin{equation*}
\mathbb{E}(Y \vert X = x) = \Pr(Y = 1 \vert X = x) = \Phi(\beta_0 + \beta_1 X),
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\Phi(x) = \Pr(Z \leq x)\)</span> for <span class="math inline">\(Z\)</span> distributed according to the standard Normal distribution (mean is 0 and standard deviation is 1). We can use <code>glm()</code> to estimate probit regressions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the variable to be 0/1 instead of 1/2</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>gss <span class="ot">&lt;-</span> gss <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diabetes_binary =</span> diabetes <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gss<span class="sc">$</span>diabetes_binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
 293 2060 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(diabetes_binary <span class="sc">~</span> educ,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"probit"</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes_binary ~ educ, family = binomial(link = "probit"), 
    data = gss)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.1448377  0.1753822   6.528 6.68e-11 ***
educ        0.0004139  0.0118182   0.035    0.972    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1760.8  on 2337  degrees of freedom
Residual deviance: 1760.8  on 2336  degrees of freedom
  (1811 observations deleted due to missingness)
AIC: 1764.8

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>The interpretation is that if <span class="math inline">\(X\)</span> increases by 1, the <span class="math inline">\(Z\)</span>-score of <span class="math inline">\(Y\)</span> changes by <span class="math inline">\(\hat{\beta}_1\)</span>. That is:</p>
<p><span class="math display">\[\begin{equation*}
\widehat{\Pr(Y = 1 \vert X = x)} = \Phi(\hat{\beta}_0 + \hat{\beta}_1 X).
\end{equation*}\]</span></p>
<p>We can implement logit by changing the link function. The equation for the logistic regression is</p>
<p><span class="math display">\[\begin{equation*}
\mathbb{E}(Y \vert X = x) = \Pr(Y = 1 \vert X = x) = \frac{\exp(\beta_0 + \beta_1 X)}{1 + \exp(\beta_0 + \beta_1 X)}.
\end{equation*}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(margins)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(diabetes_binary <span class="sc">~</span> educ,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = diabetes_binary ~ educ, family = binomial(link = "logit"), 
    data = gss)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) 1.9353024  0.3300540   5.864 4.53e-09 ***
educ        0.0007951  0.0222435   0.036    0.971    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1760.8  on 2337  degrees of freedom
Residual deviance: 1760.8  on 2336  degrees of freedom
  (1811 observations deleted due to missingness)
AIC: 1764.8

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>The interpretation is that if <span class="math inline">\(X\)</span> increases by one unit, the log of the odds ratio changes by <span class="math inline">\(\hat{\beta}_1\)</span>. The odds ratio is</p>
<p><span class="math display">\[\begin{equation*}
\ln \left[ \frac{\Pr(Y = 1)}{\Pr(Y = 0)} \right].
\end{equation*}\]</span></p>
<p>Another way to put this is that if <span class="math inline">\(X\)</span> increases by one unit the odds ratio changs by <span class="math inline">\(\exp(\hat{\beta}_1)\)</span>.</p>
<p>These are two examples of regression models with a binary outcome variable. If <span class="math inline">\(Y\)</span> is discrete but takes more than two values, then another model is needed. Multinomial logit is popular. In R, it is convenint to use the package <code>nnet</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Would you say that in general your health is Excellent, Very good, Good, Fair, or Poor?</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gss<span class="sc">$</span>health1, <span class="at">useNA =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3    4    5 &lt;NA&gt; 
 383  711  848  385   36 1786 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multinom</span>(health1 <span class="sc">~</span> educ,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">data =</span> gss) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  15 (8 variable)
initial  value 3777.350780 
iter  10 value 3222.809202
final  value 3221.902559 
converged</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = health1 ~ educ, data = gss)

Coefficients:
  (Intercept)        educ
2   0.8222059 -0.01341558
3   2.0885715 -0.08794609
4   2.1510784 -0.14766551
5   0.2127827 -0.17879801

Std. Errors:
  (Intercept)       educ
2   0.3578367 0.02343904
3   0.3438709 0.02276279
4   0.3898079 0.02635518
5   0.8370180 0.05932815

Residual Deviance: 6443.805 
AIC: 6459.805 </code></pre>
</div>
</div>
<p>Here we can interpret the coefficients as follows. We are comparing the log odds ratio of each value of <span class="math inline">\(Y\)</span> to a baseline value of <span class="math inline">\(Y\)</span>. In this example, it is <span class="math inline">\(HEALTH1 = 1\)</span>, which corresponds to excellent health. You can convert the variable to a factor and use <code>relevel()</code> to specify a different baseline category. The intercept and coefficient on <span class="math inline">\(X\)</span> depends on the level of <span class="math inline">\(Y\)</span>.</p>
</section>
<section id="the-goal-of-program-evaluation" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="the-goal-of-program-evaluation"><span class="header-section-number">15.3</span> The Goal of Program Evaluation</h2>
<p>The goal of program evaluation is to study the effectiveness of interventions. Decision makers, including policymakers and industry leaders, need to know to what extent (possibly costly) interventions will have their intended effects.</p>
<p>In public policy and economics, emblematic questions in program evaluation include:</p>
<ul>
<li>Do programs that transfer cash to individuals reduce poverty?</li>
<li>Does increasing the minimum wage affect employment?</li>
<li>Does health insurance improve health outcomes?</li>
</ul>
<p>In industry, questions requiring casual analysis might be:</p>
<ul>
<li>Does changing the price of one item affect the overall amount customers spend?</li>
<li>How does changing an interface affect user engagement?</li>
<li>Do personalized discounts or recommendations result in additional spending?</li>
</ul>
<p>To consider these questions, we cannot rely solely on basic regression analysis.</p>
<section id="causality-vs.-correlation" class="level3" data-number="15.3.1">
<h3 data-number="15.3.1" class="anchored" data-anchor-id="causality-vs.-correlation"><span class="header-section-number">15.3.1</span> Causality vs.&nbsp;Correlation</h3>
<p>Regression gets at correlation, not at causality. While this may be intuitive, we can review the fundamental concepts to have a more complete understanding of why regression may be inappropriate for drawing certain conclusions from the data.</p>
<section id="causality" class="level4" data-number="15.3.1.1">
<h4 data-number="15.3.1.1" class="anchored" data-anchor-id="causality"><span class="header-section-number">15.3.1.1</span> Causality</h4>
<p>In everyday situations, there can be a clear understanding of cause and effect. If I enter the pin of my door code, that will cause the front door of my house to unlock. There is no question here what was the cause and what was the effect. Decision makers are interested in understanding causality when it is not so obvious.</p>
<p>Causality is the effects within a causal model keeping other conditions the same (<em>ceteris paribus</em>). A causal model basically contains the following elements</p>
<ul>
<li>Variables determined inside the model (<span class="math inline">\(Y\)</span>). These are called outcome or dependent variables.</li>
<li>Variables determined outside the model <span class="math inline">\((X, U)\)</span>. These are called covariates, regressors, or independent variables.</li>
<li>Functional relationships between <span class="math inline">\((X, U)\)</span> and <span class="math inline">\(Y\)</span>. This can be written generally as <span class="math inline">\(Y = g(X,U)\)</span>.</li>
</ul>
<p>Causality refers to some inherent relationship of cause <span class="math inline">\((X, U)\)</span> and effect <span class="math inline">\(Y\)</span>.</p>
</section>
<section id="correlation" class="level4" data-number="15.3.1.2">
<h4 data-number="15.3.1.2" class="anchored" data-anchor-id="correlation"><span class="header-section-number">15.3.1.2</span> Correlation</h4>
<p>Correlation refers to a statistical relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. Mathematically, it is</p>
<p><span class="math display">\[\begin{equation*}
\rho_{X, Y} = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}.
\end{equation*}\]</span></p>
<ul>
<li><span class="math inline">\(\text{Cov}(X, Y)\)</span> is the covariance between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. It is equal to <span class="math inline">\(\mathbb{E}\left[(X - \mu_X)(Y - \mu_Y)\right]\)</span>, where <span class="math inline">\(\mu_X\)</span> and <span class="math inline">\(\mu_Y\)</span> are the means of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. The covariance measures how <span class="math inline">\(X\)</span> varies with <span class="math inline">\(Y\)</span> and how <span class="math inline">\(Y\)</span>varies with <span class="math inline">\(X\)</span>.</li>
<li><span class="math inline">\(\sigma_X\)</span> and <span class="math inline">\(\sigma_Y\)</span> are the standard deviations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Because the correlation is the covariance divided by the standard deviations, it can be thought of as a rescaled covariance. There are some important properties of correlation.</p>
<ul>
<li>Correlation is symmetric. This is one clear reason why the concepts of correlation and causality are separate.</li>
<li>The sign of the correlation is equal to the sign of the covariance.</li>
<li>The correlation is between <span class="math inline">\(-1\)</span> and <span class="math inline">\(1\)</span>. This helps give a sense of the direction and magnitude of the linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.</li>
</ul>
</section>
</section>
</section>
<section id="activity-practice-with-regression" class="level2" data-number="15.4">
<h2 data-number="15.4" class="anchored" data-anchor-id="activity-practice-with-regression"><span class="header-section-number">15.4</span> Activity: Practice with Regression</h2>
<p>This activity will help you practice regression in R. Write your code in a <code>.R</code> file and upload it to Canvas at the end of class for participation points in todayâ€™s class. You can write answers to the questions using comments. Do not worry about finsihing it, just get as far as you can. You will be graded for completion.</p>
<ol type="1">
<li><p>Go to Canvas &gt; Modules &gt; Module 1 &gt; Data. Download <code>GS2022.dta</code> and the codebook. Save them to a convenient folder.</p></li>
<li><p>What format is the data in? Load the data into R. Hint: Use the <code>haven</code> package.</p></li>
<li><p>In this activity, you will be looking at the variables <code>vote20</code> and <code>vote16</code>. Search these variables in the codebook until you get to the part that shows what the values represent.</p></li>
<li><p>Explore these variables. What is the voting turn-out in the GSS for the years 2016 and 2020? Using Google, how do they compare to the general population turn-out? What might this say about the GSS sample?</p></li>
<li><p>Create two new variables <code>vote_binary20</code> and <code>vote_binary16</code>. They should take the value <code>TRUE</code> if the individual voted and <code>FALSE</code> if they did not vote. If the individual is ineligible, the value should be <code>NA</code>. Using the command <code>table()</code>, check that your new variables are correctly defined.</p></li>
<li><p>Suppose you are interested in understanding how different characteristics are correlated with voting in the 2020 presidential election. Check the documentation and run summary statistics on the following variables about basic demographic characteristics: <code>conrinc</code>, <code>educ</code>, <code>hispanic</code>, <code>race</code>, <code>marital</code>, <code>age</code>, <code>sex</code>, <code>born</code>, <code>partyid</code>. Run a linear regression using these variables as predictors for voting in 2020. Make sure you use the variable you created in question 5.</p></li>
<li><p>Run probit and logit regressions using these varaibles as predictors for voting in 2020.</p></li>
<li><p>Based on 6 and 7, do you find anything interesting or surprising?</p></li>
<li><p>Do your own exploration of the codebook and look for other variables you think could be useful to predict voter turn-out for the 2020 presidential election. Feel free to keep or drop the variables from question 6. For each variable you use, make sure you first check the basic summary statistics of the variable.</p></li>
<li><p>Did you find anything interesting or surprising? If someone were interested in predicting voter turn-out in 2024 and 2028, what other variables might they need that are not included in this dataset?</p></li>
</ol>
</section>
<section id="references" class="level2" data-number="15.5">
<h2 data-number="15.5" class="anchored" data-anchor-id="references"><span class="header-section-number">15.5</span> References</h2>
<p>The extract from the Census comes from the <a href="https://gss.norc.org/us/en/gss/get-the-data.html">NORC</a>. See <span class="citation" data-cites="chatterjee_regression_2006">Chatterjee and Hadi (<a href="#ref-chatterjee_regression_2006" role="doc-biblioref">2006</a>)</span> for an accessible background on regression. The notes on causality draw from Matt Mastensâ€™s <em>Identification and Causality</em> notes.</p>



<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-casella_statistical_2002" class="csl-entry" role="listitem">
Casella, George, and Roger L. Berger. 2002. <em>Statistical Inference</em>. Second edition. Duxbury Advanced Series. Andover Melbourne Mexico City Stamford, CT Toronto Hong Kong New Delhi Seoul Singapore Tokyo: CENGAGE Learning. <a href="https://www.cengage.com/c/statistical-inference-2e-casella-berger/9780534243128/">https://www.cengage.com/c/statistical-inference-2e-casella-berger/9780534243128/</a>.
</div>
<div id="ref-chatterjee_regression_2006" class="csl-entry" role="listitem">
Chatterjee, Samprit, and Ali S. Hadi. 2006. <em>Regression Analysis by Example</em>. 4th ed. Wiley Series in Probability and Statistics. Hoboken (N.J.): Wiley-Interscience. <a href="https://onlinelibrary.wiley.com/doi/book/10.1002/0470055464">https://onlinelibrary.wiley.com/doi/book/10.1002/0470055464</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script>
document.querySelectorAll("tr.header").forEach(function(row) {
  const firstTh = row.querySelector("th");
  if (firstTh && firstTh.textContent.trim() === "") {
    firstTh.textContent = "Model";
  }
});
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./14_Inference.html" class="pagination-link" aria-label="Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inference</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./16_Program_Evaluation.html" class="pagination-link" aria-label="Program Evaluation">
        <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Program Evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>