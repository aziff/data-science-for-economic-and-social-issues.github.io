<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Data Management – Data Science for Economic and Social Issues</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09_Merging_and_Reshaping_Data.html" rel="next">
<link href="./07_Data_Loading_Saving.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f9a69956bae15ee19585fe71e7f92375.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
// This script is used to dynamically set the aria-label attribute for elements
document.addEventListener('DOMContentLoaded', function() {
    // Set aria-label for the label element if it is empty
    const label = document.querySelector('label.aa-Label[for^="autocomplete-0-input"]');
    // Check if the label exists and is empty
    if (label && !label.textContent.trim()){
        label.setAttribute('aria-label', 'Search');
    }
});
</script>

<script src="scroll-access.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_Data_Loading_Saving.html">Cleaning and Describing Data</a></li><li class="breadcrumb-item"><a href="./08_Data_Management.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Management</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science for Economic and Social Issues</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Setup</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_Installation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Quick Start: Installation Instructions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_Setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting Setup</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_Command_Line_and_Git.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Command Line and Git</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">R and R Markdown Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_R_Basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">R Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_R_Markdown.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_Structure.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Code Structure</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Cleaning and Describing Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_Data_Loading_Saving.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loading and Saving Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_Data_Management.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_Merging_and_Reshaping_Data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Merging and Reshaping Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_Summary_Statistics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Summary Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_Graphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_Geographic_Data_and_Mapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Geographic Data and Mapping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Methods and Econometrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_CLT.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Central Limit Theorem</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_Inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_Program_Evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Program Evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_Instrumental_Variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Instrumental Variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_Discontinuity_Designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Discontinuity Designs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./19_Difference_in_Differences.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Fixed Effects and Difference-in-Differences</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./20_EventStudies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Event Studies</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21_MachineLearning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Machine Learning Basics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#built-in-functions" id="toc-built-in-functions" class="nav-link active" data-scroll-target="#built-in-functions"><span class="header-section-number">8.1</span> Built-in Functions</a>
  <ul class="collapse">
  <li><a href="#select-variables" id="toc-select-variables" class="nav-link" data-scroll-target="#select-variables"><span class="header-section-number">8.1.1</span> Select Variables</a></li>
  <li><a href="#rename-and-create-variables" id="toc-rename-and-create-variables" class="nav-link" data-scroll-target="#rename-and-create-variables"><span class="header-section-number">8.1.2</span> Rename and Create Variables</a></li>
  <li><a href="#filter-observations" id="toc-filter-observations" class="nav-link" data-scroll-target="#filter-observations"><span class="header-section-number">8.1.3</span> Filter Observations</a></li>
  <li><a href="#organize" id="toc-organize" class="nav-link" data-scroll-target="#organize"><span class="header-section-number">8.1.4</span> Organize</a></li>
  </ul></li>
  <li><a href="#tidyverse-functions" id="toc-tidyverse-functions" class="nav-link" data-scroll-target="#tidyverse-functions"><span class="header-section-number">8.2</span> <code>tidyverse</code> Functions</a>
  <ul class="collapse">
  <li><a href="#import-and-export-readr" id="toc-import-and-export-readr" class="nav-link" data-scroll-target="#import-and-export-readr"><span class="header-section-number">8.2.1</span> Import and Export: <code>readr</code></a></li>
  <li><a href="#transform-dplyr" id="toc-transform-dplyr" class="nav-link" data-scroll-target="#transform-dplyr"><span class="header-section-number">8.2.2</span> Transform: <code>dplyr</code></a></li>
  </ul></li>
  <li><a href="#pipes" id="toc-pipes" class="nav-link" data-scroll-target="#pipes"><span class="header-section-number">8.3</span> Pipes</a>
  <ul class="collapse">
  <li><a href="#practice-exercises-2" id="toc-practice-exercises-2" class="nav-link" data-scroll-target="#practice-exercises-2"><span class="header-section-number">8.3.1</span> Practice Exercises</a></li>
  </ul></li>
  <li><a href="#further-reading" id="toc-further-reading" class="nav-link" data-scroll-target="#further-reading"><span class="header-section-number">8.4</span> Further Reading</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8.4.1</span> References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_Data_Loading_Saving.html">Cleaning and Describing Data</a></li><li class="breadcrumb-item"><a href="./08_Data_Management.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Management</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data Management</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this chapter, we will go through the R functions needed for data management. The built-in R functions are useful tools and it is important to know their syntax. There are several packages that are widely used that are helpful to work with larger data, produce cleaner code, and be more efficient in data management. The suite of packages called <code>tidyverse</code> is especially common.</p>
<p>Here are all the libraries you should install for this chapter. Most of these are packages in <code>tidyverse</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will practice with imported data. Go to <code>Canvas &gt; Modules &gt; Module 1 &gt; Data</code> for the example data. Download the entire folder <code>Gapminder</code> to a convenient file on your computer and save the file path for use in the below notes. Make sure that you have the folder unzipped and the correct path to the folder.</p>
<section id="built-in-functions" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="built-in-functions"><span class="header-section-number">8.1</span> Built-in Functions</h2>
<section id="select-variables" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="select-variables"><span class="header-section-number">8.1.1</span> Select Variables</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data/Gapminder/gapminder_large.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   195 obs. of  21 variables:
 $ country     : chr  "Afghanistan" "Albania" "Algeria" "Andorra" ...
 $ gdp_2015    : int  574 4520 4780 42100 3750 13300 10600 3920 55100 47800 ...
 $ gini_2015   : num  36.8 29 27.6 40 42.6 40 41.8 31.9 32.3 30.6 ...
 $ region      : chr  "Asia &amp; Pacific" "Europe" "Arab States" "Europe" ...
 $ co2_2015    : num  0.262 1.6 3.8 5.97 1.22 5.84 4.64 1.65 16.8 7.7 ...
 $ co2_2016    : num  0.245 1.57 3.64 6.07 1.18 5.9 4.6 1.76 17 7.7 ...
 $ co2_2017    : num  0.247 1.61 3.56 6.27 1.14 5.89 4.55 1.7 17 7.94 ...
 $ co2_2018    : num  0.254 1.59 3.69 6.12 1.12 5.88 4.41 1.89 16.9 7.75 ...
 $ cpi_2012    : int  8 33 34 NA 22 NA 35 34 85 69 ...
 $ cpi_2013    : int  8 31 36 NA 23 NA 34 36 81 69 ...
 $ cpi_2014    : int  12 33 36 NA 19 NA 34 37 80 72 ...
 $ cpi_2015    : int  11 36 36 NA 15 NA 32 35 79 76 ...
 $ cpi_2016    : int  15 39 34 NA 18 NA 36 33 79 75 ...
 $ cpi_2017    : int  15 38 33 NA 19 NA 39 35 77 75 ...
 $ lifeexp_2012: num  60.8 77.8 76.8 82.4 61.3 76.7 76 74.7 82.5 81 ...
 $ lifeexp_2013: num  61.3 77.9 76.9 82.5 61.9 76.8 76.1 75.2 82.6 81.2 ...
 $ lifeexp_2014: num  61.2 77.9 77 82.5 62.8 76.8 76.4 75.3 82.5 81.4 ...
 $ lifeexp_2015: num  61.2 78 77.1 82.6 63.3 76.9 76.5 75.3 82.5 81.5 ...
 $ lifeexp_2016: num  61.2 78.1 77.4 82.7 63.8 77 76.5 75.4 82.5 81.7 ...
 $ lifeexp_2017: num  63.4 78.2 77.7 82.7 64.2 77 76.7 75.6 82.4 81.8 ...
 $ lifeexp_2018: num  63.7 78.3 77.9 NA 64.6 77.2 76.8 75.8 82.5 81.9 ...</code></pre>
</div>
</div>
<p>Take a moment to look at the data in the data viewer. It is useful to consider the following questions whenever loading data:</p>
<ul>
<li>How many rows and columns are there?</li>
<li>What type of observation (e.g., countries, people, firms, households) do the rows represent? Another way to say this is: what is the unit of observation?</li>
<li>Are the names of the variables convenient?</li>
</ul>
<p>The built-in functions import data as data frames. Chapter 2 discusses how to select variables (columns). Here is a small review.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df[, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df[, <span class="st">"cpi_2017"</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df[, <span class="fu">c</span>(<span class="st">"lifeexp_2012"</span>, <span class="st">"cpi_2016"</span>)]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"region"</span>)]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>gini_2015</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="rename-and-create-variables" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="rename-and-create-variables"><span class="header-section-number">8.1.2</span> Rename and Create Variables</h3>
<p>The names of a data frame can be access with <code>names()</code>. This is an attribute of the data frame and can be used to rename all the variables this way.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "country"      "gdp_2015"     "gini_2015"    "region"       "co2_2015"    
 [6] "co2_2016"     "co2_2017"     "co2_2018"     "cpi_2012"     "cpi_2013"    
[11] "cpi_2014"     "cpi_2015"     "cpi_2016"     "cpi_2017"     "lifeexp_2012"
[16] "lifeexp_2013" "lifeexp_2014" "lifeexp_2015" "lifeexp_2016" "lifeexp_2017"
[21] "lifeexp_2018"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"var"</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">names</span>(df)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "var1"  "var2"  "var3"  "var4"  "var5"  "var6"  "var7"  "var8"  "var9" 
[10] "var10" "var11" "var12" "var13" "var14" "var15" "var16" "var17" "var18"
[19] "var19" "var20" "var21"</code></pre>
</div>
</div>
<p>An alternative is to use the function <code>setNames()</code>. This function can also be used for other data structures besides data frames, such as vectors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>vnames <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"country"</span>, <span class="st">"gdp_2015"</span>, <span class="st">"gini_2015"</span>, <span class="st">"region"</span>,      </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">"co2_2015"</span>, <span class="st">"co2_2016"</span>, <span class="st">"co2_2017"</span>, <span class="st">"co2_2018"</span>,   </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cpi_2012"</span>, <span class="st">"cpi_2013"</span>, <span class="st">"cpi_2014"</span>, <span class="st">"cpi_2015"</span>,    </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cpi_2016"</span>, <span class="st">"cpi_2017"</span>, <span class="st">"lifeexp_2012"</span>, <span class="st">"lifeexp_2013"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lifeexp_2014"</span>, <span class="st">"lifeexp_2015"</span>, <span class="st">"lifeexp_2016"</span>, <span class="st">"lifeexp_2017"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lifeexp_2018"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">setNames</span>(df, vnames)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "country"      "gdp_2015"     "gini_2015"    "region"       "co2_2015"    
 [6] "co2_2016"     "co2_2017"     "co2_2018"     "cpi_2012"     "cpi_2013"    
[11] "cpi_2014"     "cpi_2015"     "cpi_2016"     "cpi_2017"     "lifeexp_2012"
[16] "lifeexp_2013" "lifeexp_2014" "lifeexp_2015" "lifeexp_2016" "lifeexp_2017"
[21] "lifeexp_2018"</code></pre>
</div>
</div>
<p>It is also possible to rename a subset of the variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"COUNTRY"</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "COUNTRY"      "gdp_2015"     "gini_2015"    "region"       "co2_2015"    
 [6] "co2_2016"     "co2_2017"     "co2_2018"     "cpi_2012"     "cpi_2013"    
[11] "cpi_2014"     "cpi_2015"     "cpi_2016"     "cpi_2017"     "lifeexp_2012"
[16] "lifeexp_2013" "lifeexp_2014" "lifeexp_2015" "lifeexp_2016" "lifeexp_2017"
[21] "lifeexp_2018"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GDP"</span>, <span class="st">"GINI"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "COUNTRY"      "GDP"          "GINI"         "region"       "co2_2015"    
 [6] "co2_2016"     "co2_2017"     "co2_2018"     "cpi_2012"     "cpi_2013"    
[11] "cpi_2014"     "cpi_2015"     "cpi_2016"     "cpi_2017"     "lifeexp_2012"
[16] "lifeexp_2013" "lifeexp_2014" "lifeexp_2015" "lifeexp_2016" "lifeexp_2017"
[21] "lifeexp_2018"</code></pre>
</div>
</div>
<p>Creating new variables can be done with <code>cbind()</code> as discussed in chapter 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>random1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">dim</span>(df)[<span class="dv">1</span>])</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(random1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.0554011 -1.4637454 -0.5282606  1.5977476 -0.9002189  0.2934467</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df, random1)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"random1"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      COUNTRY    random1
1 Afghanistan  1.0554011
2     Albania -1.4637454
3     Algeria -0.5282606
4     Andorra  1.5977476
5      Angola -0.9002189</code></pre>
</div>
</div>
<p>This method has the advantage that it can be used to add more than one variable at a time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>random2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="fu">dim</span>(df)[<span class="dv">1</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>random3 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="fu">dim</span>(df)[<span class="dv">1</span>])</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(df, random2, random3)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"random2"</span>, <span class="st">"random3"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      COUNTRY    random2   random3
1 Afghanistan 0.54912043 0.3842395
2     Albania 0.80180192 2.0000175
3     Algeria 0.66452378 0.6596464
4     Andorra 0.07791196 0.9120150
5      Angola 0.23502908 0.4231180</code></pre>
</div>
</div>
<p>The following shortcut is helpful to create one variable at a time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>random4 <span class="ot">&lt;-</span> df<span class="sc">$</span>random3<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"random4"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      COUNTRY   random4
1 Afghanistan 0.1476400
2     Albania 4.0000700
3     Algeria 0.4351334
4     Andorra 0.8317714
5      Angola 0.1790288</code></pre>
</div>
</div>
</section>
<section id="filter-observations" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="filter-observations"><span class="header-section-number">8.1.3</span> Filter Observations</h3>
<p>Filtering observations can be done by row name or number, as shown in chapter 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, ]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">40</span>), ]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df[<span class="fu">c</span>(<span class="st">"4"</span>, <span class="st">"17"</span>), ]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>df[<span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">190</span>), ]</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>df[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">190</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Filtering can also be done using logical statements.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df[df<span class="sc">$</span>random2 <span class="sc">&gt;=</span> <span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] COUNTRY      GDP          GINI         region       co2_2015    
 [6] co2_2016     co2_2017     co2_2018     cpi_2012     cpi_2013    
[11] cpi_2014     cpi_2015     cpi_2016     cpi_2017     lifeexp_2012
[16] lifeexp_2013 lifeexp_2014 lifeexp_2015 lifeexp_2016 lifeexp_2017
[21] lifeexp_2018 random1      random2      random3      random4     
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[df<span class="sc">$</span>random2 <span class="sc">&gt;=</span> <span class="dv">1</span> <span class="sc">&amp;</span> df<span class="sc">$</span>random3 <span class="sc">&lt;=</span> <span class="fl">0.5</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] COUNTRY      GDP          GINI         region       co2_2015    
 [6] co2_2016     co2_2017     co2_2018     cpi_2012     cpi_2013    
[11] cpi_2014     cpi_2015     cpi_2016     cpi_2017     lifeexp_2012
[16] lifeexp_2013 lifeexp_2014 lifeexp_2015 lifeexp_2016 lifeexp_2017
[21] lifeexp_2018 random1      random2      random3      random4     
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(df, df<span class="sc">$</span>random3 <span class="sc">&lt;=</span> <span class="fl">0.05</span>)[, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"random3"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         COUNTRY     random3
65       Germany 0.008742552
72        Guyana 0.048876320
73         Haiti 0.001249049
74      Honduras 0.029414866
147 Saudi Arabia 0.026581063
179       Uganda 0.027493716</code></pre>
</div>
</div>
<p>The <code>which()</code> function returns the row numbers that are being filtered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(df<span class="sc">$</span>random3 <span class="sc">&lt;=</span> <span class="fl">0.05</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  65  72  73  74 147 179</code></pre>
</div>
</div>
</section>
<section id="organize" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="organize"><span class="header-section-number">8.1.4</span> Organize</h3>
<p>Sorting can be done by one or more columns. Note that even though the rows are re-ordered, the original row names remain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dforder1 <span class="ot">&lt;-</span> <span class="fu">order</span>(df<span class="sc">$</span>GINI)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[dforder1, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"GINI"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            COUNTRY GINI
180         Ukraine 24.8
154        Slovenia 25.6
46   Czech Republic 26.0
153 Slovak Republic 26.7
16          Belarus 26.9
87       Kazakhstan 26.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dforder2 <span class="ot">&lt;-</span> <span class="fu">order</span>(df<span class="sc">$</span>region, df<span class="sc">$</span>GINI)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df[dforder2, <span class="fu">c</span>(<span class="st">"COUNTRY"</span>, <span class="st">"region"</span>, <span class="st">"GINI"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  COUNTRY region GINI
146 Sao Tome and Principe Africa 30.8
105                  Mali Africa 33.0
96                Liberia Africa 33.3
70                 Guinea Africa 33.7
151          Sierra Leone Africa 34.0
125                 Niger Africa 34.1</code></pre>
</div>
</div>
</section>
</section>
<section id="tidyverse-functions" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="tidyverse-functions"><span class="header-section-number">8.2</span> <code>tidyverse</code> Functions</h2>
<p>Hadley Wickham developed the idea behind a suite of packages that streamline data work called <code>tidyverse</code>. There are many packages in this suite that relate to different types of datasets and parts of the data process. This chapter goes through <code>dplyr</code>, <code>tidyr</code>, and <code>readr</code>.</p>
<section id="import-and-export-readr" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="import-and-export-readr"><span class="header-section-number">8.2.1</span> Import and Export: <code>readr</code></h3>
<p>The functions in the <code>readr</code> package to read and write data are faster than the built-in functions. Apart from efficiency, they have another advantage in that they help ensure consistency in the imported data. For example, if there are spaces in the variable name, <code>read.csv()</code>, the built-in function, will automatically remove these. The <code>readr</code> function <code>read_csv()</code> will not remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tib1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Gapminder/gapminder.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 197 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): country, region
dbl (2): gdp, gini

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tib1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [197 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ country: chr [1:197] "Afghanistan" "Albania" "Algeria" "Andorra" ...
 $ gdp    : num [1:197] 574 4520 4780 42100 3750 13300 10600 3920 55100 47800 ...
 $ gini   : num [1:197] 36.8 29 27.6 40 42.6 40 41.8 31.9 32.3 30.6 ...
 $ region : chr [1:197] "Asia &amp; Pacific" "Europe" "Arab States" "Europe" ...
 - attr(*, "spec")=
  .. cols(
  ..   country = col_character(),
  ..   gdp = col_double(),
  ..   gini = col_double(),
  ..   region = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>Immediately, you can see that the data structure is different. The package <code>readr</code>, and all the packages in the <code>tidyverse</code> suite, rely on a data structure called tibbles instead of data frames. The two main differences between tibbles and data frames are the following. More information on the differences is available <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html">here</a>.</p>
<ul>
<li><p>Unlike data frames, tibbles only show the first 10 rows and enough columns to fit on the screen. Each column is printed with its type.</p></li>
<li><p>When subsetting, <code>[]</code> always returns another tibble and <code>[[]]</code> always returns a vector.</p></li>
</ul>
<p>Just like in <code>read.csv()</code>, you can specify the columns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>tib2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Gapminder/gapminder.csv"</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_types =</span> <span class="fu">list</span>(<span class="fu">col_character</span>(),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">col_integer</span>(),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">col_double</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">col_factor</span>()))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tib2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [197 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ country: chr [1:197] "Afghanistan" "Albania" "Algeria" "Andorra" ...
 $ gdp    : int [1:197] 574 4520 4780 42100 3750 13300 10600 3920 55100 47800 ...
 $ gini   : num [1:197] 36.8 29 27.6 40 42.6 40 41.8 31.9 32.3 30.6 ...
 $ region : Factor w/ 7 levels "Asia &amp; Pacific",..: 1 2 3 2 4 5 5 2 1 2 ...
 - attr(*, "spec")=
  .. cols(
  ..   country = col_character(),
  ..   gdp = col_integer(),
  ..   gini = col_double(),
  ..   region = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE)
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>If you want to completely rename the columns, you can do so with the option <code>col_names</code>. You will just need to tell R to skip reading in the first line of the file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>tib3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Gapminder/gapminder.csv"</span>, <span class="at">skip =</span> <span class="dv">1</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span>, <span class="st">"V4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 197 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): V1, V4
dbl (2): V2, V3

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(tib3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [197 × 4] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
 $ V1: chr [1:197] "Afghanistan" "Albania" "Algeria" "Andorra" ...
 $ V2: num [1:197] 574 4520 4780 42100 3750 13300 10600 3920 55100 47800 ...
 $ V3: num [1:197] 36.8 29 27.6 40 42.6 40 41.8 31.9 32.3 30.6 ...
 $ V4: chr [1:197] "Asia &amp; Pacific" "Europe" "Arab States" "Europe" ...
 - attr(*, "spec")=
  .. cols(
  ..   V1 = col_character(),
  ..   V2 = col_double(),
  ..   V3 = col_double(),
  ..   V4 = col_character()
  .. )
 - attr(*, "problems")=&lt;externalptr&gt; </code></pre>
</div>
</div>
<p>The argument <code>n_max</code> determines the maximum number of lines that are read.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(<span class="st">"Data/Gapminder/gapminder.csv"</span>, <span class="at">n_max =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 3 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): country, region
dbl (2): gdp, gini

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  country       gdp  gini region        
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         
1 Afghanistan   574  36.8 Asia &amp; Pacific
2 Albania      4520  29   Europe        
3 Algeria      4780  27.6 Arab States   </code></pre>
</div>
</div>
<p>The <code>readr</code> analogues to <code>read.table()</code> and <code>read.delim()</code> are <code>read_table()</code> and <code>read_delim()</code>. They have similar arguments as <code>read_csv()</code>. Reading in data files usually presents unexpected difficulties and complications, and the myriad of arguments available can help address any formatting issues automatically.</p>
<p>The write functions in <code>readr</code> are faster than the built-in functions and automatically omit row names.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_csv</span>(df, <span class="at">file =</span> <span class="st">"Data/Gapminder/Output_Data/df_csv_readr.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="practice-exercises" class="level4" data-number="8.2.1.1">
<h4 data-number="8.2.1.1" class="anchored" data-anchor-id="practice-exercises"><span class="header-section-number">8.2.1.1</span> Practice Exercises</h4>
<ol type="1">
<li>Another way to list the column types is string shortcuts. For example <code>"d"</code> for double, <code>"c"</code> for character, etc. Check the documentation for <code>read_csv()</code>, and call in <code>"gapminder.csv"</code> with a character column, an integer column, a double column, and a factor column.</li>
<li>You can also easily skip columns with this shorthand. Why do you think this be useful? Call in <code>"gapminder.csv"</code> again skipping the <code>Region</code> column.</li>
</ol>
</section>
</section>
<section id="transform-dplyr" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="transform-dplyr"><span class="header-section-number">8.2.2</span> Transform: <code>dplyr</code></h3>
<p>The package <code>dplyr</code> includes functions that transform tibbles and data frames.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Data/Gapminder/gapminder.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 197 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): country, region
dbl (2): gdp, gini

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country               gdp  gini region             
  &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 Afghanistan           574  36.8 Asia &amp; Pacific     
2 Albania              4520  29   Europe             
3 Algeria              4780  27.6 Arab States        
4 Andorra             42100  40   Europe             
5 Angola               3750  42.6 Africa             
6 Antigua and Barbuda 13300  40   South/Latin America</code></pre>
</div>
</div>
<section id="select-variables-1" class="level4" data-number="8.2.2.1">
<h4 data-number="8.2.2.1" class="anchored" data-anchor-id="select-variables-1"><span class="header-section-number">8.2.2.1</span> Select Variables</h4>
<p>The general form of functions in <code>dplyr</code> involves identifying the data frame first and then specifying the options. To demonstrate, the function <code>select</code> chooses which variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 1
   country            
   &lt;chr&gt;              
 1 Afghanistan        
 2 Albania            
 3 Algeria            
 4 Andorra            
 5 Angola             
 6 Antigua and Barbuda
 7 Argentina          
 8 Armenia            
 9 Australia          
10 Austria            
# ℹ 187 more rows</code></pre>
</div>
</div>
<p>Note that the original data frame is not changed. You will have to assign an object if you want to save this selection in an object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tib1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country               gdp  gini region             
  &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 Afghanistan           574  36.8 Asia &amp; Pacific     
2 Albania              4520  29   Europe             
3 Algeria              4780  27.6 Arab States        
4 Andorra             42100  40   Europe             
5 Angola               3750  42.6 Africa             
6 Antigua and Barbuda 13300  40   South/Latin America</code></pre>
</div>
</div>
<p>There are several ways to select more than one variable. The last method used a helper, <code>starts_with()</code>. See the documentation for <code>select</code> for other helpers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, country, gdp)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, gdp<span class="sc">:</span>gini)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, <span class="sc">-</span>gdp)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, <span class="sc">-</span><span class="fu">c</span>(country, gini))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, <span class="fu">starts_with</span>(<span class="st">"g"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sometimes it is desirable to rename variables when selecting them. This is very convenient in <code>select</code>!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, <span class="at">country_name =</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 1
   country_name       
   &lt;chr&gt;              
 1 Afghanistan        
 2 Albania            
 3 Algeria            
 4 Andorra            
 5 Angola             
 6 Antigua and Barbuda
 7 Argentina          
 8 Armenia            
 9 Australia          
10 Austria            
# ℹ 187 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(tib1, <span class="at">var =</span> <span class="fu">starts_with</span>(<span class="st">"g"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 2
    var1  var2
   &lt;dbl&gt; &lt;dbl&gt;
 1   574  36.8
 2  4520  29  
 3  4780  27.6
 4 42100  40  
 5  3750  42.6
 6 13300  40  
 7 10600  41.8
 8  3920  31.9
 9 55100  32.3
10 47800  30.6
# ℹ 187 more rows</code></pre>
</div>
</div>
</section>
<section id="rename-and-create-variables-1" class="level4" data-number="8.2.2.2">
<h4 data-number="8.2.2.2" class="anchored" data-anchor-id="rename-and-create-variables-1"><span class="header-section-number">8.2.2.2</span> Rename and Create Variables</h4>
<p>If you want to rename variables without dropping any, use the function <code>rename</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(tib1, <span class="at">country_name =</span> country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
   country_name          gdp  gini region             
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Afghanistan           574  36.8 Asia &amp; Pacific     
 2 Albania              4520  29   Europe             
 3 Algeria              4780  27.6 Arab States        
 4 Andorra             42100  40   Europe             
 5 Angola               3750  42.6 Africa             
 6 Antigua and Barbuda 13300  40   South/Latin America
 7 Argentina           10600  41.8 South/Latin America
 8 Armenia              3920  31.9 Europe             
 9 Australia           55100  32.3 Asia &amp; Pacific     
10 Austria             47800  30.6 Europe             
# ℹ 187 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(tib1, <span class="at">country_name =</span> country, <span class="at">gdp_percapita =</span> gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
   country_name        gdp_percapita  gini region             
   &lt;chr&gt;                       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Afghanistan                   574  36.8 Asia &amp; Pacific     
 2 Albania                      4520  29   Europe             
 3 Algeria                      4780  27.6 Arab States        
 4 Andorra                     42100  40   Europe             
 5 Angola                       3750  42.6 Africa             
 6 Antigua and Barbuda         13300  40   South/Latin America
 7 Argentina                   10600  41.8 South/Latin America
 8 Armenia                      3920  31.9 Europe             
 9 Australia                   55100  32.3 Asia &amp; Pacific     
10 Austria                     47800  30.6 Europe             
# ℹ 187 more rows</code></pre>
</div>
</div>
<p>The function <code>mutate()</code> allows for new variables to be added to the data frame or existing variables to be modified without changing the other variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(tib1, <span class="at">gdp_sq =</span> gdp<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 5
   country               gdp  gini region                  gdp_sq
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;
 1 Afghanistan           574  36.8 Asia &amp; Pacific          329476
 2 Albania              4520  29   Europe                20430400
 3 Algeria              4780  27.6 Arab States           22848400
 4 Andorra             42100  40   Europe              1772410000
 5 Angola               3750  42.6 Africa                14062500
 6 Antigua and Barbuda 13300  40   South/Latin America  176890000
 7 Argentina           10600  41.8 South/Latin America  112360000
 8 Armenia              3920  31.9 Europe                15366400
 9 Australia           55100  32.3 Asia &amp; Pacific      3036010000
10 Austria             47800  30.6 Europe              2284840000
# ℹ 187 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(tib1, <span class="at">row_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(country))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 5
   country               gdp  gini region              row_id
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                &lt;int&gt;
 1 Afghanistan           574  36.8 Asia &amp; Pacific           1
 2 Albania              4520  29   Europe                   2
 3 Algeria              4780  27.6 Arab States              3
 4 Andorra             42100  40   Europe                   4
 5 Angola               3750  42.6 Africa                   5
 6 Antigua and Barbuda 13300  40   South/Latin America      6
 7 Argentina           10600  41.8 South/Latin America      7
 8 Armenia              3920  31.9 Europe                   8
 9 Australia           55100  32.3 Asia &amp; Pacific           9
10 Austria             47800  30.6 Europe                  10
# ℹ 187 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(tib1, <span class="at">gdp_large =</span> <span class="fu">ifelse</span>(gdp <span class="sc">&gt;=</span> <span class="dv">25000</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 5
   country               gdp  gini region              gdp_large
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;               &lt;lgl&gt;    
 1 Afghanistan           574  36.8 Asia &amp; Pacific      FALSE    
 2 Albania              4520  29   Europe              FALSE    
 3 Algeria              4780  27.6 Arab States         FALSE    
 4 Andorra             42100  40   Europe              TRUE     
 5 Angola               3750  42.6 Africa              FALSE    
 6 Antigua and Barbuda 13300  40   South/Latin America FALSE    
 7 Argentina           10600  41.8 South/Latin America FALSE    
 8 Armenia              3920  31.9 Europe              FALSE    
 9 Australia           55100  32.3 Asia &amp; Pacific      TRUE     
10 Austria             47800  30.6 Europe              TRUE     
# ℹ 187 more rows</code></pre>
</div>
</div>
<p>If you want to create a new variable and drop the other variables, use the function <code>transmute()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(tib1, <span class="at">gini_small =</span> <span class="fu">ifelse</span>(gini <span class="sc">&lt;=</span> <span class="dv">40</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 1
   gini_small
   &lt;lgl&gt;     
 1 TRUE      
 2 TRUE      
 3 TRUE      
 4 TRUE      
 5 FALSE     
 6 TRUE      
 7 FALSE     
 8 TRUE      
 9 TRUE      
10 TRUE      
# ℹ 187 more rows</code></pre>
</div>
</div>
</section>
<section id="filter-observations-1" class="level4" data-number="8.2.2.3">
<h4 data-number="8.2.2.3" class="anchored" data-anchor-id="filter-observations-1"><span class="header-section-number">8.2.2.3</span> Filter Observations</h4>
<p>The function <code>select</code> allows you to choose which variables (columns) are included in your data. The function <code>filter</code> allows you choose which observations (rows) are included in your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, region <span class="sc">==</span> <span class="st">"North America"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  country         gdp  gini region       
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
1 Canada        50300  31.7 North America
2 United States 52100  41.3 North America</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, <span class="fu">is.na</span>(gdp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  country         gdp  gini region             
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 Djibouti         NA  44.1 Arab States        
2 Eritrea          NA  40   Africa             
3 Liechtenstein    NA  40   Europe             
4 Venezuela        NA  46.9 South/Latin America
5 Holy See         NA  40   Europe             
6 North Korea      NA  37   Asia &amp; Pacific     
7 Somalia          NA  48   Arab States        
8 Syria            NA  35.2 Asia &amp; Pacific     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, gdp <span class="sc">&gt;</span> <span class="dv">25000</span> <span class="sc">&amp;</span> region <span class="sc">!=</span> <span class="st">"Europe"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   country                gdp  gini region             
   &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Australia            55100  32.3 Asia &amp; Pacific     
 2 Bahamas              27500  43.7 South/Latin America
 3 Brunei               32900  40   Asia &amp; Pacific     
 4 Canada               50300  31.7 North America      
 5 Japan                47100  32.1 Asia &amp; Pacific     
 6 Kuwait               36000  40   Middle east        
 7 New Zealand          36800  34.5 Asia &amp; Pacific     
 8 Qatar                65100  40   Middle east        
 9 Singapore            54000  40.9 Asia &amp; Pacific     
10 South Korea          26100  31.6 Asia &amp; Pacific     
11 United Arab Emirates 40200  40   Middle east        
12 United States        52100  41.3 North America      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, region <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"North America"</span>, <span class="st">"Middle east"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 14 × 4
   country                gdp  gini region       
   &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
 1 Canada               50300  31.7 North America
 2 Egypt                 2700  31.2 Middle east  
 3 Iran                  6070  38.5 Middle east  
 4 Iraq                  5300  29.5 Middle east  
 5 Jordan                3310  33.7 Middle east  
 6 Kuwait               36000  40   Middle east  
 7 Lebanon               6490  31.8 Middle east  
 8 Libya                 5900  40   Middle east  
 9 Oman                 16200  40   Middle east  
10 Qatar                65100  40   Middle east  
11 Saudi Arabia         21400  40   Middle east  
12 United Arab Emirates 40200  40   Middle east  
13 United States        52100  41.3 North America
14 Yemen                  785  36.7 Middle east  </code></pre>
</div>
</div>
<p>To select rows based on the number index, use <code>slice</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice</span>(tib1, <span class="dv">32</span><span class="sc">:</span><span class="dv">37</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  country                    gdp  gini region             
  &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 Cape Verde                3410  47.2 Africa             
2 Central African Republic   347  56.2 Africa             
3 Chad                       957  43.3 Africa             
4 Chile                    14700  47.5 South/Latin America
5 China                     6500  39.4 Asia &amp; Pacific     
6 Colombia                  7580  51.7 South/Latin America</code></pre>
</div>
</div>
<p>The function <code>distinct()</code> filters out duplicated rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(tib1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 195 × 4
   country               gdp  gini region             
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Afghanistan           574  36.8 Asia &amp; Pacific     
 2 Albania              4520  29   Europe             
 3 Algeria              4780  27.6 Arab States        
 4 Andorra             42100  40   Europe             
 5 Angola               3750  42.6 Africa             
 6 Antigua and Barbuda 13300  40   South/Latin America
 7 Argentina           10600  41.8 South/Latin America
 8 Armenia              3920  31.9 Europe             
 9 Australia           55100  32.3 Asia &amp; Pacific     
10 Austria             47800  30.6 Europe             
# ℹ 185 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, <span class="fu">duplicated</span>(tib1)) <span class="co"># Check which observations are duplicated</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  country    gdp  gini region             
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 Norway   90000  27.1 Europe             
2 Suriname  8460  61   South/Latin America</code></pre>
</div>
</div>
<p>The function <code>slice_sample()</code> randomly selects rows.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(tib1, <span class="at">n =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  country                gdp  gini region             
  &lt;chr&gt;                &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
1 United Arab Emirates 40200  40   Middle east        
2 Maldives              7500  38.4 Asia &amp; Pacific     
3 Poland               14600  31.7 Europe             
4 Suriname              8460  61   South/Latin America</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(tib1, <span class="at">prop =</span> <span class="fl">0.03</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 4
  country       gdp  gini region
  &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; 
1 Luxembourg 108000  32.9 Europe
2 Namibia      6270  59.5 Africa
3 Albania      4520  29   Europe
4 Russia      11400  38.8 Europe
5 Romania      9710  32.1 Europe</code></pre>
</div>
</div>
</section>
<section id="organize-1" class="level4" data-number="8.2.2.4">
<h4 data-number="8.2.2.4" class="anchored" data-anchor-id="organize-1"><span class="header-section-number">8.2.2.4</span> Organize</h4>
<p>The functions so far produce data frames that explicitly differ from the inputted data frame. There are some silent functions that change the underlying structure without changing the outputted data frame. The function <code>group_by()</code> is an example of these silent functions. It groups the data based on the values of a set of variables. It makes most sense to group by categorical variables. The only difference is that now it says <code>Groups: region [7]</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>group_tib1 <span class="ot">&lt;-</span> <span class="fu">group_by</span>(tib1, region)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>group_tib1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
# Groups:   region [7]
   country               gdp  gini region             
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Afghanistan           574  36.8 Asia &amp; Pacific     
 2 Albania              4520  29   Europe             
 3 Algeria              4780  27.6 Arab States        
 4 Andorra             42100  40   Europe             
 5 Angola               3750  42.6 Africa             
 6 Antigua and Barbuda 13300  40   South/Latin America
 7 Argentina           10600  41.8 South/Latin America
 8 Armenia              3920  31.9 Europe             
 9 Australia           55100  32.3 Asia &amp; Pacific     
10 Austria             47800  30.6 Europe             
# ℹ 187 more rows</code></pre>
</div>
</div>
<p>Ungrouping the data is another silent function and it removes this underlying grouping.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ungroup</span>(group_tib1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
   country               gdp  gini region             
   &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Afghanistan           574  36.8 Asia &amp; Pacific     
 2 Albania              4520  29   Europe             
 3 Algeria              4780  27.6 Arab States        
 4 Andorra             42100  40   Europe             
 5 Angola               3750  42.6 Africa             
 6 Antigua and Barbuda 13300  40   South/Latin America
 7 Argentina           10600  41.8 South/Latin America
 8 Armenia              3920  31.9 Europe             
 9 Australia           55100  32.3 Asia &amp; Pacific     
10 Austria             47800  30.6 Europe             
# ℹ 187 more rows</code></pre>
</div>
</div>
<p>The function <code>arrange</code> sorts the data based on the rank order of a set of variables. Adding <code>desc()</code> changes the rank-order to descending.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(tib1, gini)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
   country           gdp  gini region        
   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         
 1 Ukraine          2830  24.8 Europe        
 2 Slovenia        23800  25.6 Europe        
 3 Czech Republic  21400  26   Europe        
 4 Slovak Republic 18900  26.7 Europe        
 5 Belarus          6380  26.9 Europe        
 6 Kazakhstan      10600  26.9 Asia &amp; Pacific
 7 Moldova          2950  27   Europe        
 8 Finland         45600  27.1 Europe        
 9 Norway          90000  27.1 Europe        
10 Norway          90000  27.1 Europe        
# ℹ 187 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(tib1, <span class="fu">desc</span>(region), gini)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 197 × 4
   country                          gdp  gini region             
   &lt;chr&gt;                          &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;              
 1 Antigua and Barbuda            13300  40   South/Latin America
 2 Dominica                        6890  40   South/Latin America
 3 Grenada                         8190  40   South/Latin America
 4 St. Kitts and Nevis            16700  40   South/Latin America
 5 St. Vincent and the Grenadines  6580  40   South/Latin America
 6 Uruguay                        13900  40.1 South/Latin America
 7 El Salvador                     3310  41.1 South/Latin America
 8 Trinidad and Tobago            16800  41.3 South/Latin America
 9 Argentina                      10600  41.8 South/Latin America
10 St. Lucia                       8490  42.6 South/Latin America
# ℹ 187 more rows</code></pre>
</div>
</div>
</section>
<section id="practice-exercises-1" class="level4" data-number="8.2.2.5">
<h4 data-number="8.2.2.5" class="anchored" data-anchor-id="practice-exercises-1"><span class="header-section-number">8.2.2.5</span> Practice Exercises</h4>
<ol type="1">
<li>Before running this code, what do you think the output will be? Check to see if you were right!</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(popA, tib1, <span class="at">by =</span> <span class="st">"country"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="pipes" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="pipes"><span class="header-section-number">8.3</span> Pipes</h2>
<p>The <code>magrittr</code> package contains the pipe operator, <code>%&gt;%</code>. The purpose of this operator is to make code clearer and more efficient. The idea is to minimize unnecessary saved objects. For example, if you are cleaning a dataset, it would be cumbersome to save a new data frame for each step in the cleaning process. Pipe operators, or pipes, help with this.</p>
<p>The idea is that the pipe forwards a value to the next function. The two lines result in the same output. The first argument of <code>filter()</code> is forwarded by the pipe operator.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(tib1, region <span class="sc">==</span> <span class="st">"North America"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  country         gdp  gini region       
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
1 Canada        50300  31.7 North America
2 United States 52100  41.3 North America</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>tib1 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"North America"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  country         gdp  gini region       
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        
1 Canada        50300  31.7 North America
2 United States 52100  41.3 North America</code></pre>
</div>
</div>
<p>Pipe operators are especially useful when there are several operations being applied to the same object.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 195 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (1): population

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 11 Columns: 2
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): country
dbl (1): population

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>tib1 <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(pop, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(region), <span class="fu">desc</span>(population)) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country     gdp  gini region              population
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Brazil    11400  51.6 South/Latin America  204000000
2 Mexico    10000  46.5 South/Latin America  122000000
3 Colombia   7580  51.7 South/Latin America   47500000
4 Argentina 10600  41.8 South/Latin America   43100000
5 Peru       6110  43.7 South/Latin America   30500000
6 Venezuela    NA  46.9 South/Latin America   30100000</code></pre>
</div>
</div>
<p>To highlight the utility of pipe operators, consider these alternatives. They produce the same results. The first approach results in two objects that are not necessary for the final analysis, <code>tmp1</code> and <code>tmp2</code>. These objects are created with the sole purpose of being used in other functions. If the dataset is large, saving different versions of it can be burdensome. Additionally, the workspace becomes messy with so many temporary objects. While the second approach avoids temporary versions, it is difficult to read and understand.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>tmp1 <span class="ot">&lt;-</span> <span class="fu">distinct</span>(tib1)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>tmp2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(tmp1, pop, <span class="at">by =</span> <span class="st">"country"</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">arrange</span>(tmp2, <span class="fu">desc</span>(region), <span class="fu">desc</span>(population))</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country     gdp  gini region              population
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Brazil    11400  51.6 South/Latin America  204000000
2 Mexico    10000  46.5 South/Latin America  122000000
3 Colombia   7580  51.7 South/Latin America   47500000
4 Argentina 10600  41.8 South/Latin America   43100000
5 Peru       6110  43.7 South/Latin America   30500000
6 Venezuela    NA  46.9 South/Latin America   30100000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">arrange</span>(<span class="fu">distinct</span>(<span class="fu">full_join</span>(tib1, pop, <span class="at">by =</span> <span class="st">"country"</span>)), <span class="fu">desc</span>(region), <span class="fu">desc</span>(population)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country     gdp  gini region              population
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                    &lt;dbl&gt;
1 Brazil    11400  51.6 South/Latin America  204000000
2 Mexico    10000  46.5 South/Latin America  122000000
3 Colombia   7580  51.7 South/Latin America   47500000
4 Argentina 10600  41.8 South/Latin America   43100000
5 Peru       6110  43.7 South/Latin America   30500000
6 Venezuela    NA  46.9 South/Latin America   30100000</code></pre>
</div>
</div>
<p>Note that the pipe operator can be used with functions outside of the <code>tidyverse</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(df, pop, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="st">"Data/Gapminder/Output_Data/country_info.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pipe operators can forward objects to other arguments besides the first one. A period (<code>.</code>) indicates this. Here is an example with plotting (see chapter 7).</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 195 Columns: 21
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (2): country, region
dbl (19): gdp_2015, gini_2015, co2_2015, co2_2016, co2_2017, co2_2018, cpi_2...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  country gdp_2015 gini_2015 region co2_2015 co2_2016 co2_2017 co2_2018 cpi_2012
  &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Afghan…      574      36.8 Asia …    0.262    0.245    0.247    0.254        8
2 Albania     4520      29   Europe    1.6      1.57     1.61     1.59        33
3 Algeria     4780      27.6 Arab …    3.8      3.64     3.56     3.69        34
4 Andorra    42100      40   Europe    5.97     6.07     6.27     6.12        NA
5 Angola      3750      42.6 Africa    1.22     1.18     1.14     1.12        22
6 Antigu…    13300      40   South…    5.84     5.9      5.89     5.88        NA
# ℹ 12 more variables: cpi_2013 &lt;dbl&gt;, cpi_2014 &lt;dbl&gt;, cpi_2015 &lt;dbl&gt;,
#   cpi_2016 &lt;dbl&gt;, cpi_2017 &lt;dbl&gt;, lifeexp_2012 &lt;dbl&gt;, lifeexp_2013 &lt;dbl&gt;,
#   lifeexp_2014 &lt;dbl&gt;, lifeexp_2015 &lt;dbl&gt;, lifeexp_2016 &lt;dbl&gt;,
#   lifeexp_2017 &lt;dbl&gt;, lifeexp_2018 &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>tib1 <span class="sc">%&gt;%</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(pop, <span class="at">by =</span> <span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gini_2015), <span class="at">data =</span> .) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">stat =</span> <span class="st">"bin"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="08_Data_Management_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" alt="Histogram of gini_2015 values with a peak around 40, showing distribution across countries." width="672"></p>
</figure>
</div>
</div>
</div>
<p>Getting comfortable with <code>%&gt;%</code> can vastly smooth your workflow in R. Another useful pipe is <code>%&lt;&gt;%</code> which functions the same as <code>%&gt;%</code> but also assigns the object (it is called the assginment pipe). These two lines of code result in the same tibble.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>tib1 <span class="ot">&lt;-</span> tib1 <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>tib1 <span class="sc">%&lt;&gt;%</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="practice-exercises-2" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="practice-exercises-2"><span class="header-section-number">8.3.1</span> Practice Exercises</h3>
<ol type="1">
<li>Use pipes to accomplish the following tasks on <code>tib1</code>: select <code>country</code>, <code>region</code>, <code>co2_2015</code>, and <code>co2_2016</code>, remove rows with missing values for either CO2 variables, create a variable that is <code>TRUE</code> when CO2 emissions in 2016 are smaller than those in 2015, and only keep the rows where this variable is <code>TRUE</code>.</li>
<li>If you are curious, look at the documentation for <code>?magrittr</code>. There are four types of pipes. Take a moment to familiarize yourself with their differences.</li>
</ol>
</section>
</section>
<section id="further-reading" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="further-reading"><span class="header-section-number">8.4</span> Further Reading</h2>
<p>There are many great resources online, including cheat sheets. <a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-transformation.pdf">Here</a> is one for <code>dplyr</code>. Save this cheat sheet if you find it useful! More cheat sheets can be found <a href="https://www.rstudio.com/resources/cheatsheets/">here</a>.</p>
<p>The above information comes from chapters 5.1-5.3, 6, and 21 of <span class="citation" data-cites="boehmke_data_2016">Boehmke (<a href="#ref-boehmke_data_2016" role="doc-biblioref">2016</a>)</span>, chapters 2.2.5 and 3 of <span class="citation" data-cites="zamora_saiz_introduction_2020">Zamora Saiz et al. (<a href="#ref-zamora_saiz_introduction_2020" role="doc-biblioref">2020</a>)</span>. See <span class="citation" data-cites="zamora_saiz_introduction_2020">Zamora Saiz et al. (<a href="#ref-zamora_saiz_introduction_2020" role="doc-biblioref">2020</a>)</span> chapter 3 for information on <code>data.table</code>.</p>
<section id="references" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="references"><span class="header-section-number">8.4.1</span> References</h3>



<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-boehmke_data_2016" class="csl-entry" role="listitem">
Boehmke, Bradley C. 2016. <em>Data <span>Wrangling</span> with <span>R</span></em>. Use <span>R</span>! Springer. <a href="https://link.springer.com/book/10.1007/978-3-319-45599-0">https://link.springer.com/book/10.1007/978-3-319-45599-0</a>.
</div>
<div id="ref-zamora_saiz_introduction_2020" class="csl-entry" role="listitem">
Zamora Saiz, Alfonso, Carlos Quesada González, Lluís Hurtado Gil, and Diego Mondéjar Ruiz. 2020. <em>An Introduction to Data Analysis in <span>R</span>: Hands-on Coding, Data Mining, Visualization and Statistics from Scratch</em>. <a href="https://link.springer.com/book/10.1007/978-3-030-48997-7">https://link.springer.com/book/10.1007/978-3-030-48997-7</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script>
document.querySelectorAll("tr.header").forEach(function(row) {
  const firstTh = row.querySelector("th");
  if (firstTh && firstTh.textContent.trim() === "") {
    firstTh.textContent = "Model";
  }
});
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07_Data_Loading_Saving.html" class="pagination-link" aria-label="Loading and Saving Data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Loading and Saving Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09_Merging_and_Reshaping_Data.html" class="pagination-link" aria-label="Merging and Reshaping Data">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Merging and Reshaping Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>